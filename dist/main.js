!function(){"use strict";const t={ie:0|Number(document.documentMode),on:document.addEventListener?function(t,e,n){t&&e&&n&&t.addEventListener(e,n,!1)}:function(t,e,n){t&&e&&n&&t.attachEvent("on"+e,n)},off:document.removeEventListener?function(t,e,n){t&&e&&t.removeEventListener(e,n,!1)}:function(t,e,n){t&&e&&t.detachEvent("on"+e,n)},once:function(t,e,n){var s=this.off,i=function(){n&&n.apply(this,arguments),s(t,e,i)};this.on(t,e,i)},position:function(t){const e=t.getBoundingClientRect(),{clientTop:n,clientLeft:s}=document.documentElement,{pageYOffset:i,pageXOffset:o}=window;return{top:e.top-n,left:e.left-s,height:e.height,width:e.width,pageYOffset:i,pageXOffset:o}},el:function(t,e){return e||(e=document),e.querySelector(t)},els:function(t,e){return e||(e=document),[].slice.call(e.querySelectorAll(t))},hasClass:function(t,e){if(!t||!e)return!1;if(-1!==e.indexOf(" "))throw new Error("className should not contain space.");return t.classList?t.classList.contains(e):(" "+t.className+" ").indexOf(" "+e+" ")>-1},addClass:function(t,e){if(t){for(var n=t.className,s=(e||"").split(" "),i=0,o=s.length;i<o;i++){var a=s[i];a&&(t.classList?t.classList.add(a):this.hasClass(t,a)||(n+=" "+a))}t.classList||(t.className=n)}},removeClass:function(t,e){if(t&&e){for(var n=e.split(" "),s=" "+t.className+" ",i=0,o=n.length;i<o;i++){var a=n[i];a&&(t.classList?t.classList.remove(a):this.hasClass(t,a)&&(s=s.replace(" "+a+" "," ")))}t.classList||(t.className=s)}},append(t,e){e||(e=document.body),e.appendChild(t)},remove(t){t&&t.parentNode&&t.parentNode.removeChild(t)},isHTMLElement:t=>t instanceof window.HTMLElement||t instanceof HTMLElement,getScrollParent(t){try{function e(t,e="y"){let n=window.getComputedStyle(t),s=n.overflow,i=n.overflowX,o=n.overflowY;return/scroll|overlay|auto/.test(("y"===e?o:i)||s)}let n=t.parentNode;return this.isHTMLElement(n)?e(n)?n:this.getScrollParent(n):t}catch(s){}return window},setTransform(t,e){let n=["webkit","Moz","O","ms"].map((t=>`${t}Transform`));if(n.unshift("transform"),this.isHTMLElement(t))for(let s in n)if(void 0!==t.style[n[s]])return t.style[n[s]]=e}};let e={attr:"data-u-dialog"};const n=t=>void 0===t;var s=new function(){this.dom=t;const s=(s={})=>{let i=e.attr;n(s.shadow)&&(s.shadow=!0),n(s.shadowClose)&&(s.shadowClose=!0),n(s.showClose)&&(s.showClose=!1);var o,a=s.uniqueId||this.uniqueId("U");if(s.uniqueId){let n=t.el("#"+a),s=e["timer_"+a];n&&t.hasClass(n,"u-dialog")&&(o=n),t.removeClass(o,"is-show"),s&&clearTimeout(s)}if(!o){const l=document.createElement("div");l.className="u-dialog-mask",s.shadow&&t.addClass(l,"is-show"),s.shadow<1&&s.shadow>0&&(l.style.opacity=s.shadow),l.setAttribute("data-u-dialog",a),o=document.createElement("div"),s.uniqueId&&(o.id=a),o.className="u-dialog "+(n(s.ani)?"u-dialog-ani":s.ani),s.before&&s.before(o),s.after&&(e["after_"+a]=s.after);const r=s.skin||s.className;r&&t.addClass(o,r),s.extend&&(t.addClass(o,"is-extend"),t.addClass(l,"is-extend")),o.setAttribute("data-u-dialog",a),l.oncontextmenu=o.oncontextmenu=()=>!1,s.shadowClose&&(l.onclick=()=>this.hideToast(l.getAttribute(i))),s.shadow&&t.append(l),t.append(o)}const l=(t="")=>t.replace(/ipt>/g,"ipt&gt;");s.title=l(s.title),s.content=l(String(s.content)),s.width=s.width?s.width:"auto",s.height=s.height?s.height:"auto";let r=s.showClose?'<div class="u-dialog-close is-show">x</div>':"";return o.innerHTML=`\n      <div class="u-dialog-content" style="width:${s.width};height:${s.height}">\n        <div class="u-dialog-title${s.title?" is-show":""}"> ${s.title}</div>\n        <div class="u-dialog-body">${s.content}</div>${r}\n      </div> `,this.refreshOffset(o,s.offset),s.showClose&&t.on(t.el(".u-dialog-close",o),"click",(()=>this.hideToast(o.getAttribute(i)))),s.time&&(e["timer_"+a]=setTimeout((()=>this.hideToast(o.getAttribute(i))),1e3*s.time)),"function"==typeof s.success&&s.success(a,o),a};this.uniqueId=(t="")=>t+(+new Date).toString(32),this.refreshOffset=(e,n=["auto","auto"])=>{const s=window.innerHeight,i=window.innerWidth;e.style.top="auto"===n[0]?Math.max((s-e.clientHeight)/2,0)+"px":n[0],e.style.left="auto"===n[1]?Math.max((i-e.clientWidth)/2,0)+"px":n[1],t.addClass(e,"is-show");try{let n=t.el(".u-dialog-content",e),i=t.el(".u-dialog-title",e).clientHeight,o=s-i;n.style.maxHeight=o+"px",t.el(".u-dialog-body",e).style.maxHeight=o-i+"px"}catch(t){}{let t=e.clientHeight+e.offsetTop,n=e.clientWidth+e.offsetLeft;t>s-10&&(e.style.top=Math.max(e.offsetTop-e.clientHeight,0)+"px"),n>i-10&&(e.style.left=Math.max(e.offsetLeft-e.clientWidth,0)+"px")}},this.hideToast=n=>{let s=s=>{t.removeClass(s,"is-show");let i=e["after_"+n];!t.hasClass(s,"u-dialog-mask")&&i&&(i(s),e["after_"+n]=null),e["timer_"+n]=setTimeout((()=>{t.remove(s),e["timer_"+n]=null}),300)};t.els(`[${e.attr}]`).forEach((i=>{n?n==i.getAttribute(e.attr)&&s(i):!t.hasClass(i,"is-extend")&&s(i)}))},this.toast=(t,e=2)=>(this.hideToast(),s({className:"u-dialog__toast",content:t,width:"auto",shadow:!1,shadowClose:!1,time:e})),this.showLoading=n=>{let i=t.el(".u-dialog__loading");return i?(t.el("p",i).innerHTML=n,i.getAttribute(e.attr)):(this.hideToast(),s({className:"u-dialog__loading",content:`<i></i><p>${n||""}</p>`,width:"120px",height:"120px",shadow:.3,shadowClose:!1}))},this.showSuccess=(t,e=2)=>(this.hideToast(),s({className:"u-dialog__success",content:`<i></i><p>${t||""}</p>`,width:"120px",height:"120px",shadow:!1,shadowClose:!1,time:e})),this.alert=(e,i)=>{this.hideToast(),i=Object.assign({},i),"string"==typeof e&&(e={content:e}),n(e.width)&&(e.width="380px"),n(e.time)&&(e.time=0),n(e.title)&&(e.title="提示"),n(e.showClose)&&(e.showClose=!1),"object"==typeof e.ok&&(i.confirmText=e.ok.label,i.confirmSkin=e.ok.skin,i.confirm=e.ok.onclick),"object"==typeof e.cancel&&(i.cancelText=e.cancel.label,i.cancelSkin=e.cancel.skin,i.cancel=e.cancel.onclick);let o="function"==typeof i.confirm;n(e.shadowClose)&&(e.shadowClose=!o),i.cancelText||(i.cancelText="取消");let a="",l=`<a class="u-btn">${i.cancelText}</a>`;return o&&(i.confirmText=i.confirmText||"确认",i.confirmSkin=i.confirmSkin||"u-btn--blue",a=`<a class="u-btn u-btn--primary ${i.confirmSkin}">${i.confirmText}</a>`),e.skin="u-dialog__alert",e.content=`<div class="u-dialog__alert-content">${e.content}</div><div class="u-dialog__alert-btns">${a}${l}</div><div></div>`,e.success=(e,n)=>{t.els(".u-btn",n).forEach((n=>{t.on(n,"click",(()=>{t.hasClass(n,"u-btn--primary")&&o?i.confirm(e,n):"function"==typeof i.cancel?i.cancel(e,n):this.hideToast(e)}))}))},s(e)},this.showNearby=(t={})=>(this.hideToast(),t.skin="u-dialog__nearby "+(t.skin||t.className||""),s(Object.assign({},{shadow:!1,height:"auto",width:"auto",time:2,showClose:!1},t))),this.showModal=t=>(this.hideToast(),"string"==typeof t&&(t={content:t}),n(t.width)&&(t.width="320px"),n(t.height)&&(t.height="240px"),n(t.time)&&(t.time=0),n(t.shadowClose)&&(t.shadowClose=!1),n(t.showClose)&&(t.showClose=!0),s(t)),this.showPopover=e=>this.showModal(Object.assign({},e,{shadow:!1,width:"auto",height:"auto",showClose:!1,extend:!0,success:(n,s)=>{t.once(t.getScrollParent(e.el),"scroll",(()=>this.hideToast(n))),setTimeout((()=>{t.once(document,"contextmenu",(()=>this.hideToast(n))),t.once(document,"click",(()=>this.hideToast(n)))}),100),t.on(s,"contextmenu",(t=>{t.stopPropagation(),t.preventDefault()})),t.on(s,"click",(t=>{t.stopPropagation(),t.preventDefault()})),e.success&&e.success(n,s)}})),e.createContextLabel=({skin:t,list:e,value:n=""})=>e.reduce(((e,s,i)=>{let o="",a=s.children&&s.children.length;return a&&(o=render(s.children)),e+`<div class="${t}-item${s.border?" is-border":""}${s.disabled?" is-disabled":""}${a?" is-children":""}${s.value==n?" is-active":""}" data-value="${s.value}">${s.label}${o}</div>`}),""),this.showDropdown=n=>{let{offset:s,success:i,el:o,list:a,value:l}=n;const r="u-dialog--dropdown";return this.showPopover(Object.assign({},n,{skin:r,content:e.createContextLabel({skin:r,list:a,value:l}),success:(e,n)=>{t.els(`.${r}-item`).forEach((n=>{t.hasClass(n,"is-disabled")||t.hasClass(n,"is-children")||t.on(n,"click",(t=>{i&&i({label:n.innerText,value:n.getAttribute("data-value")}),this.hideToast(e)}))}))}}))},this.showContextMenu=n=>{let{offset:s,success:i,el:o,list:a}=n;const l="u-dialog--contextmenu";return this.showPopover(Object.assign({},n,{skin:l,content:e.createContextLabel({skin:l,list:a}),success:(e,n)=>{let s=t.els(`.${l}-item`),o=1===s.length;s.forEach((n=>{t.hasClass(n,"is-disabled")||t.hasClass(n,"is-children")||(o&&(n.style.lineHeight=n.offsetHeight+2+"px"),t.on(n,"click",(t=>{i&&i({label:n.innerText,value:n.getAttribute("data-value")}),this.hideToast(e)})))}))}}))},this.uploadAvatar=function(e={}){const n=this.showModal;!function(e){let n=document.createElement("input");n.type="file",n.accept="image/*",n.onchange=t=>{const s=(t.target||t.path[0]).files[0];let{name:i,size:o,type:a}=s;{const t=new FileReader;t.readAsDataURL(s);let n=new Image;t.onload=({target:t})=>{n.onload=()=>{e(n,{width:n.width,height:n.height,size:o,MB:Math.ceil(o/1024/1024*100)/100,name:i,type:a})},n.src=t.result}}n=null},t.ie&&t.ie<=10&&(n.style.clip="rect(0px, 0px, 0px, 0px)",t.append(n),setTimeout((e=>t.remove(n)),100)),n.click()}(((s,i)=>{const o=240;function a(t,e){return t/(e/160)}function l(t,e,n){return n>e?e:n<t?t:n}var r;("function"!=typeof e.change||e.change(i))&&(r=(t,e)=>{const{width:n,height:r}=i,c=(i={left:0,top:0})=>{e.clearRect(0,0,o,o),e.fillStyle="#ccc",e.fillRect(0,0,o,o),e.fill();let c,h,d=n>=r,u=0|t.getAttribute("data-left"),g=0|t.getAttribute("data-top");if(d){c=a(n,r),h=160,u=u||(o-c)/2,g=g||40;let t=h+40-c;u+=i.left,u=l(t,40,u)}else{c=160,h=a(r,n),u=u||40,g=g||(o-h)/2;let t=c+40-h;g+=i.top,g=l(t,40,g)}return e.drawImage(s,u,g,c,h),e.stroke(),e.fillStyle="rgba(250,250,250,.88)",e.fillRect(0,0,40,240),e.fillRect(200,0,40,240),e.fillRect(40,0,160,40),e.fillRect(40,200,160,40),e.fill(),{left:u,top:g}};c({left:0,top:0}),this.addMoveEvent({el:t,success:c})},n({extend:!0,title:e.title||"上传头像",shadow:.8,width:"auto",height:"auto",content:`<div class="u-center u-nos">\n                   <p style="margin: 20px 0;color: #888;">${e.desc||"调整头像位置"}</p>\n                   <div style="padding: 10px 40px;"><canvas width="240" height="240" style="width: 240px; height: 240px; cursor: grab;"></canvas></div>\n                   <p style="margin:40px 0"><button style="width:240px;" class="${e.btnClass||"u-btn"}"> 保存</button></p>\n                   </div> `,success(n,s){let i=t.el("canvas",s);const o=i.getContext("2d");{r(i,o);let a=t.el("button",s);t.on(a,"click",(function(){let t=o.getImageData(40,40,160,160),s=document.createElement("canvas"),i=s.getContext("2d");s.width=s.height=160,i.putImageData(t,0,0);let a=s.toDataURL("image/png",.91);t=s=i=null,"function"==typeof e.success&&e.success(a,n)}))}}}))}))},this.addMoveEvent=function({el:e,success:n,doc:s=document}){t.on(e,"mousedown",(i=>{let o=i.pageX||i.clientX,a=i.pageY||i.clientY;e.style.cursor="grabbing";let l=!0;const r=t=>{if(l){let e=t.pageX||t.clientX,s=t.pageY||t.clientY;n({left:e-o,top:s-a})}},c=i=>{e.style.cursor="grab";let h=i.pageX||i.clientX,d=i.pageY||i.clientY,u=n({left:h-o,top:d-a});u&&(e.setAttribute("data-left",0|u.left),e.setAttribute("data-top",0|u.top)),l=!1,t.off(s,"mouseup",c),t.off(s,"mousemove",r)};t.on(s,"mousemove",r),t.on(s,"mouseup",c)}))},this.showImageView=function(t){const{dom:e,showModal:n,hideToast:s}=this,i=t,{naturalWidth:o,naturalHeight:a}=i;if(!e.isHTMLElement(i)&&"IMG"!==i.nodeName)return;const l=e.position(i),r=t=>{t.style.left=l.left+"px",t.style.top=l.top+"px",t.style.width=l.width+"px",t.style.height=l.height+"px",e.setTransform(t,"scale(1)")};let c=l.width,h=l.height,d=1;{let t=Math.min(window.innerWidth,o);t=.8*t/c;let e=Math.min(window.innerHeight,a);e=.8*e/h,d=Math.max(Math.min(t,e),1)}n({content:"",shadowClose:!0,showClose:!1,width:c+"px",height:h+"px",before(t){t.style.transition="all 300ms ease-in-out",r(t)},after(t){e.addClass(t,"is-show"),r(t)},success(t,n){let s=e.el(".u-dialog-body",n);s.style.padding="0";let o=i.cloneNode(!1);s.append(o),e.setTransform(n,`scale(${d})`)}})}};const i={toString:function(t,e){let n,s=(t="object"!=typeof t?new Date(t):t).getFullYear(),i=t.getMonth()+1,o=t.getDate(),a=t.getHours(),l=t.getMinutes(),r=t.getSeconds();return i=parseInt(i)<10?"0"+i:i,o=parseInt(o)<10?"0"+o:o,a=parseInt(a)<10?"0"+a:a,l=parseInt(l)<10?"0"+l:l,r=parseInt(r)<10?"0"+r:r,n="yyyy-MM-dd HH:mm:ss"===e?s+"-"+i+"-"+o+" "+a+":"+l+":"+r:"yyyy-MM"===e?s+"-"+i:"HH:mm"===e?a+":"+l:"yyyy"===e?s:s+"-"+i+"-"+o,n},toDate:function(t){if(19===t.length){let e=t.substring(0,4),n=t.substring(5,7),s=t.substring(8,10),i=t.substring(11,13),o=t.substring(14,16),a=t.substring(17,19);return new Date(e,n-1,s,i,o,a)}if(10===t.length){let e=t.substring(0,4),n=t.substring(5,7),s=t.substring(8,10);return new Date(e,n-1,s)}if(7===t.length){let e=t.substring(0,4),n=t.substring(5,7);return new Date(e,n-1)}if(4===t.length){let e=t.substring(0,4);return new Date(e)}},getMonthDays:function(t,e){let n=t.getFullYear();return void 0===e&&(e=t.getMonth()),0!=n%4||0==n%100&&0!=n%400||1!==e?[31,28,31,30,31,30,31,31,30,31,30,31][e]:29},addDays:function(t,e,n){let s=1===arguments.length?this.toDate(this.today()):this.toDate(e);return s=new Date(s.getTime()+24*parseInt(t)*3600*1e3),this.toString(new Date(s),n)},addMonths:function(t,e,n){let s=1===arguments.length?this.toDate(this.today()):this.toDate(e),i=(s.getMonth(),s.getDate()),o=this.getMonthDays(s,s.getMonth()+parseInt(t));return i>o&&s.setDate(o),s.setMonth(s.getMonth()+parseInt(t)),this.toString(s,n)},addMonthsForStart:function(t,e){let n=1===arguments.length?this.today():e;return n=this.addMonths(t,n),this.firstDayOfMonth(n)},addMonthsForEnd:function(t,e){let n=1===arguments.length?this.today():e;return n=this.addMonths(t,n),this.addDays(-1,this.firstDayOfMonth(n))},addYears:function(t,e,n){let s=1===arguments.length?this.toDate(this.today()):this.toDate(e);return s.setYear(s.getFullYear()+parseInt(t)),this.toString(s,n)},addYearsForStart:function(t,e){let n=1===arguments.length?this.today():e;return n=this.addYears(t,n),this.firstDayOfYear(n)},addYearsForEnd:function(t,e){let n=1===arguments.length?this.today():e;return n=this.addYears(t,n),this.firstDayOfYear(n)},sunOfWeek:function(t,e){let n=0===arguments.length?this.toDate(this.today()):this.toDate(t);return n=new Date(n-864e5*n.getDay()),this.toString(n,e)},monOfWeek:function(t,e){let n=0===arguments.length?this.toDate(this.today()):this.toDate(t);return n=new Date(n-864e5*(n.getDay()-1)),this.toString(n,e)},tueOfWeek:function(t,e){let n=0===arguments.length?this.toDate(this.today()):this.toDate(t);return n=new Date(n-864e5*(n.getDay()-2)),this.toString(n,e)},wedOfWeek:function(t,e){let n=0===arguments.length?this.toDate(this.today()):this.toDate(t);return n=new Date(n-864e5*(n.getDay()-3)),this.toString(n,e)},turOfWeek:function(t,e){let n=0===arguments.length?this.toDate(this.today()):this.toDate(t);return n=new Date(n-864e5*(n.getDay()-4)),this.toString(n,e)},friOfWeek:function(t,e){let n=0===arguments.length?this.toDate(this.today()):this.toDate(t);return n=new Date(n-864e5*(n.getDay()-5)),this.toString(n,e)},satOfWeek:function(t,e){let n=0===arguments.length?this.toDate(this.today()):this.toDate(t);return n=new Date(n-864e5*(n.getDay()-6)),this.toString(n,e)},firstDayOfMonth:function(t,e){let n=0===arguments.length?this.toDate(this.today()):this.toDate(t);return n.setDate(1),this.toString(n,e)},lastDayOfMonth:function(t){return t=0===arguments.length?this.today():t,t=this.addMonths(1,t),t=this.firstDayOfMonth(t),this.addDays(-1,t)},firstDayOfYear:function(t,e){let n=0===arguments.length?this.toDate(this.today()):this.toDate(t);return n.setMonth(0),n.setDate(1),this.toString(n,e)},lastDayOfYear:function(t,e){let n=0===arguments.length?this.toDate(this.today()):this.toDate(t);return n.setMonth(11),n.setDate(31),this.toString(n,e)},today:function(t){return 0===arguments.length?this.toString(new Date,"yyyy-MM-dd"):this.toString(new Date,t)}},o={loadJs:function(t){return new Promise(((e,n)=>{let s=document.getElementsByTagName("head")[0],i=document.createElement("script");i.onload=i.onreadystatechange=i.onerror=function(){i&&i.readyState&&/^(?!(?:loaded|complete)$)/.test(i.readyState)||(i.onload=i.onreadystatechange=i.onerror=null,i.src="",i.parentNode.removeChild(i),i=null,e&&e())},i.src=t;try{s.appendChild(i)}catch(t){n&&n()}}))},loadCss:function(t,e){let n=document.getElementsByTagName("head")[0],s=document.createElement("link"),i=document.getElementById(e);s.onload=s.onreadystatechange=s.onerror=null,s.rel="stylesheet",s.href=t;try{i?s=null:(e&&(s.id=e),n.appendChild(s))}catch(t){}},is:function(){let t={},e=navigator.userAgent;return t.ios=!!e.match(/(iphone|ipod|ipad)/i),t.android=!!e.match(/android/i),t.wechat=!!e.match(/micromessenger/i),e=e.match(/msie \d+?/i),t.ie=function(){let t=navigator.userAgent.toLowerCase();return!(!window.ActiveXObject&&!("ActiveXObject"in window))&&((t.match(/msie\s(\d+)/)||[])[1]||"11")}(),t}(),regexp:{mobile:/^1\d{10}$/g,email:/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,required:/[\S]+/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,image:/\.(png|jpg|gif|jpeg|webp)$/i},cookie:{set(t,e,n,s,i,o){if(i){var a=new Date;a.setTime(a.getTime()+1e3*i*60*60*24),i=a,a=null}document.cookie=t+"="+(o?e:escape(e))+(i?"; expires="+i.toGMTString():"")+(s?"; path="+s:"; path=/")+(n?"; domain="+n:"")},get(t,e){var n=document.cookie.match(new RegExp("(^| )"+t+"=([^;]*)(;|$)"));return null!=n?unescape(n[2]):e},clear(t,e,n){this.get(t)&&(document.cookie=t+"="+(e?"; path="+e:"; path=/")+(n?"; domain="+n:"")+";expires=Fri, 02-Jan-1970 00:00:00 GMT")}},session:{set:function(t,e){return window.sessionStorage.setItem(t,o.stringify(e))},get:function(t){let e=window.sessionStorage.getItem(t)||"";return o.parse(e)},clear:function(t){return window.sessionStorage.removeItem(t)}},store:{set:function(t,e){return window.localStorage.setItem(t,o.stringify(e))},get:function(t){let e=window.localStorage.getItem(t)||"";return o.parse(e)},clear:function(t){return window.localStorage.removeItem(t)}},stringify:function(t){if("object"==typeof t)try{t=JSON.stringify(t)}catch(t){}return t},parse:function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}return t},clone:function(t){return"object"==typeof t?this.parse(this.stringify(t)):t},toPercent:function(t){return(Math.round(1e4*t)/100).toFixed(2)+"%"},toThousands:function(t){if(t=String(t),"NaN"===String(+t))return t;let e=t,n="";if(~e.indexOf(".")){let[t,s]=e.split(".");e=t,n=+s,n=n?`.${n}`:""}return String(e).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$&,")+n},toMB:function(t){let e=0;for(;t>1024;)t/=1024,e++;return t.toFixed(2)+(e?"BKMGT".charAt(e):"")+"B"}};Object.assign(o,s,{date:i})}();